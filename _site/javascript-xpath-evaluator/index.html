<!DOCTYPE html>
<html>
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>JavaScript XPath Evaluator for OpenRosa/JavaRosa</title>
   <meta name="author" content="Martijn van de Rijdt" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0" />
   <meta name="apple-mobile-web-app-capable" content="yes" />
   <link rel="alternate" type="application/rss+xml" title="Enketo Blog" href="http://blog.enketo.orgfeed/" />

   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
   <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

   <link rel="shortcut icon" href="/images/enketo.ico">
   <!-- For third-generation iPad with high-resolution Retina display: -->
   <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/icon_144x144.png">
   <!-- For iPhone with high-resolution Retina display: -->
   <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/icon_114x114.png">
   <!-- For first- and second-generation iPad: -->
   <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/icon_72x72.png">
   <!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
   <link rel="apple-touch-icon-precomposed" href="/images/icon_57x57.png">
   <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
   <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
<body> 
   <header class="navbar navbar-fixed-top">
      <section class="content navbar-innner">
         <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
            </a>
            <a class="brand" href="/" title="Blog about Enketo and other tools for Aid Workers">Enketo Blog</a>
            <nav class="nav-collapse collapse">
               <ul class="nav nav-pills">
                  <li class="active"><a href="/">Blog</a></li>
                  <li><a href="http://enketo.org">Home</a></li>
                  <li class="nav-icon"><a href="http://github.com/martijnr/" title="Go to GitHub"><i class="icon-github"></i></a></li>
                  <li class="nav-icon"><a href="http://twitter.com/enketo/" title="Follow on Twitter"><i class="icon-twitter"></i></a></li>
                  <li class="nav-icon"><a href="http://www.linkedin.com/in/martijnvanderijdt/" title="Follow on LinkedIn"><i class="icon-linkedin"></i></a></li>
                  <li class="nav-icon"><a href="http://blog.enketo.org/feed/" title="Subscribe to RSS Feed"><i class="icon-feed"></i></a></li>
               </ul>
            </nav>
         </div>
      </section>
   </header>
   <div class="container main">
      <article class="content">

        <article id="post">
	<h2>JavaScript XPath Evaluator for OpenRosa/JavaRosa</h2>
	<p>After finding a suitable <a href="/enketos-new-architecture/" title="Enketo’s New Architecture">open-source form format</a> to use in enketo there was need to properly evaluate the very powerful processing logic it supports. For example, the format allows you to describe how one survey question depends on the answer to an earlier question. This logic is written in a language called <em>XPath</em> and I therefore needed an <em>XPath Evaluator</em>. Since enketo is offline-capable this processor would have to work without server interaction inside a browser. This meant I could not use the open-source Java libraries provided by the JavaRosa project.</p>

<p>Initially, I had high hopes for the (crazy fast) native XPath evaluator built into modern browsers. However, it became apparent that it is not really possible to extend this with custom functions. Moreover, browsers do not all implement XPath in the same way (sigh…). XPath is an extensible language and has been extended with useful functions in JavaRosa, so extensibility was crucial. Eventually, I found an excellent cross-browser open-source project called<a href="https://github.com/andrejpavlovic/xpathjs" title="XPathJS on GitHub"> XPathJS </a>by Andrej Pavlovic (Andrej, thank you for making this available!). I forked his project and simply added the custom functions and the custom (date) datatype that JavaRosa has included in their format.</p>

<p><a href="https://github.com/MartijnR/xpathjs_javarosa/" title="XPathJS_javarosa on GitHub"><img src="../files/2012/08/Screen-Shot-2012-08-21-at-11.33.20-AM-300x220.png" alt="xpathjs_javarosa github screenshot" /></a></p>

<p>My port is now available on GitHub and is called <a href="https://github.com/MartijnR/xpathjs_javarosa/" title="XPathJS_javarosa on GitHub">XPathJS_javarosa</a>. Hopefully, this project will contribute to the creation of more JavaRosa clients for the browser and allow the format to be adopted on a wider scale. I think it is a great thing for organizations when they can easily swap different components (data server, data entry client, form builder) of their information management system. The ability to switch to something new when it becomes available and may meet requirements better – and even to do this on a per-survey basis – is a great advantage compared to systems using proprietary formats and communication protocols. On this note, it is worth mentioning that <a href="http://formhub.org" title="formhub web site">formhub</a> just added a feature to allow survey administrators to <a href="http://blog.formhub.org/2012/08/06/posting-to-external-site/" title="formhub blog post on posting data to an external site">post data to an external site</a>, which supports this ability to swap and try out new tools. Very cool!</p>

	
	<section class="comments">
		<div id="disqus_thread"></div>
	    <script type="text/javascript">
	        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	        var disqus_shortname = 'webtoolsforaidworkers'; // required: replace example with your forum shortname

	        /* * * DON'T EDIT BELOW THIS LINE * * */
	        (function() {
	            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	        })();
	    </script>
	    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	</section>
	
</article>

<section id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>17 May 2013</span> &raquo; <a href="/nomad-presention-2013/">Presentation on Enketo for Humanitarian Nomad 2013</a></li>
    
      <li><span>16 May 2013</span> &raquo; <a href="/enketo-branding/">Smart Paper</a></li>
    
      <li><span>05 Mar 2013</span> &raquo; <a href="/enketo-performance/">Enketo starts to fly</a></li>
    
  </ul>
</section>

      </article>
   </div>
     
   <footer>
      <section class="content">
         <a class="enketo-icon" href="http://enketo.org" title="Go to Enketo.org"><img src="images/icon_144x144.png" alt="enketo icon"/></a>
         <div class="copyright">&copy; 2013, Enketo LLC</div>
         <div class="info">
            <a href="http://github.com/martijnr/" title="Go to GitHub"><i class="icon-github"></i></a>
            <a href="http://twitter.com/enketo/" title="Follow on Twitter"><i class="icon-twitter"></i></a>
            <a href="http://www.linkedin.com/in/martijnvanderijdt/" title="Follow on LinkedIn"><i class="icon-linkedin"></i></a>
            <a href="http://blog.enketo.org/feed/" title="Subscribe to RSS Feed"><i class="icon-feed"></i></a>
         </div>
      </section>
   </footer>

   <!-- Google Analytics -->
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-6765789-12', 'enketo.org');
     ga('send', 'pageview');

   </script>
   <!-- Google Analytics end -->

   </body>
</html>
