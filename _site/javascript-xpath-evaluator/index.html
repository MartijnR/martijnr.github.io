<!DOCTYPE html>
<html>
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>JavaScript XPath Evaluator for OpenRosa/JavaRosa</title>
   <meta name="author" content="Martijn van de Rijdt" />
   <link rel="alternate" type="application/rss+xml" title="Enketo Blog" href="http://blog.enketo.orgfeed/" />

   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />

</head>
<body>

<div class="site">
  <div class="title">
    <a href="/">Enketo Blog</a>
    <a class="extra" href="/">home</a>
  </div>
  
  <article id="post">
	<h2>JavaScript XPath Evaluator for OpenRosa/JavaRosa</h2>
	<p>After finding a suitable <a href='/enketos-new-architecture/' title='Enketo’s New Architecture'>open-source form format</a> to use in enketo there was need to properly evaluate the very powerful processing logic it supports. For example, the format allows you to describe how one survey question depends on the answer to an earlier question. This logic is written in a language called <em>XPath</em> and I therefore needed an <em>XPath Evaluator</em>. Since enketo is offline-capable this processor would have to work without server interaction inside a browser. This meant I could not use the open-source Java libraries provided by the JavaRosa project.</p>

<p>Initially, I had high hopes for the (crazy fast) native XPath evaluator built into modern browsers. However, it became apparent that it is not really possible to extend this with custom functions. Moreover, browsers do not all implement XPath in the same way (sigh…). XPath is an extensible language and has been extended with useful functions in JavaRosa, so extensibility was crucial. Eventually, I found an excellent cross-browser open-source project called<a href='https://github.com/andrejpavlovic/xpathjs' title='XPathJS on GitHub'>XPathJS</a>by Andrej Pavlovic (Andrej, thank you for making this available!). I forked his project and simply added the custom functions and the custom (date) datatype that JavaRosa has included in their format.</p>

<p><a href='https://github.com/MartijnR/xpathjs_javarosa/' title='XPathJS_javarosa on GitHub'><img src='../files/2012/08/Screen-Shot-2012-08-21-at-11.33.20-AM-300x220.png' alt='xpathjs_javarosa github screenshot' /></a></p>

<p>My port is now available on GitHub and is called <a href='https://github.com/MartijnR/xpathjs_javarosa/' title='XPathJS_javarosa on GitHub'>XPathJS_javarosa</a>. Hopefully, this project will contribute to the creation of more JavaRosa clients for the browser and allow the format to be adopted on a wider scale. I think it is a great thing for organizations when they can easily swap different components (data server, data entry client, form builder) of their information management system. The ability to switch to something new when it becomes available and may meet requirements better – and even to do this on a per-survey basis – is a great advantage compared to systems using proprietary formats and communication protocols. On this note, it is worth mentioning that <a href='http://formhub.org' title='formhub web site'>formhub</a> just added a feature to allow survey administrators to <a href='http://blog.formhub.org/2012/08/06/posting-to-external-site/' title='formhub blog post on posting data to an external site'>post data to an external site</a>, which supports this ability to swap and try out new tools. Very cool!</p>
	
	<section class="comments">
		<div id="disqus_thread"></div>
	    <script type="text/javascript">
	        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	        var disqus_shortname = 'webtoolsforaidworkers'; // required: replace example with your forum shortname

	        /* * * DON'T EDIT BELOW THIS LINE * * */
	        (function() {
	            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	        })();
	    </script>
	    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	</section>
	
</article>

<section id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>05 Mar 2013</span> &raquo; <a href="/enketo-performance/">Enketo starts to fly</a></li>
    
      <li><span>13 Dec 2012</span> &raquo; <a href="/enketo-a-unique-survey-app/">Enketo: Why so awesome?</a></li>
    
      <li><span>12 Sep 2012</span> &raquo; <a href="/enketo-is-now-open-source-and-will-be-used-in-formhub/">Enketo is now open source and will be used in formhub!</a></li>
    
  </ul>
</section>
  
  <div class="footer">
    <div class="contact">
      <p>Enketo &amp; other web tools for Aid Workers</p>
    </div>
    <div class="contact">
      <p>
        <a href="http://github.com/martijnr/">github.com/martijnr</a><br />
        <a href="http://twitter.com/enketo/">twitter.com/enketo</a><br />
      </p>
    </div>
    <div class="rss">
      <a href="http://blog.enketo.orgfeed/rss.xml">
        <img src="/images/rss.png" alt="Subscribe to RSS Feed" />
      </a>
    </div>
  </div>
</div>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6765789-12', 'enketo.org');
  ga('send', 'pageview');

</script>
<!-- Google Analytics end -->

</body>
</html>
